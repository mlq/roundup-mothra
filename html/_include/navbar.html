<header class="navbar navbar-default navbar-fixed-top">
  <a class="navbar-brand" href="/">
    <i class="fa fa-heart"></i> mothra
  </a>

  <button type="button" class="navbar-toggle collapsed"
    data-toggle="collapse" data-target=".navbar-responsive-collapse">
    <i class="fa fa-ellipsis-v"></i>
  </button>

  <nav id="top-menu" class="navbar-collapse navbar-responsive-collapse collapse">
    <ul class="nav navbar-nav pull-right">
      {% if request.user.hasPermission('Register', 'user') %}
        <li>
          <a href="user?@template=register">
            <i class="fa fa-fw fa-hand-o-up"></i> {{ i18n.gettext('Register') }}
          </a>
        </li>
      {% endif %}

      {% if request.user.username == 'anonymous' %}
        <li class="dropdown">
          <a class="dropdown-toggle" id="login-menu" data-toggle="dropdown" href="#">
            <i class="fa fa-fw fa-sign-in"></i> Login
            <span class="caret"></span>
          </a>
          <div class="dropdown-menu" role="form" aria-labelledby="login-menu">
            <form method="POST" action='{{ request.base }}'
              parsley-validate
              novalidate>
              <fieldset>
                <label for="login-name">{{ i18n.gettext('Username') }}</label>
                <input class="form-control input-small" type='text' name="__login_name"
                  placeholder='{{ i18n.gettext('Username') }}'
                  required="required">

                <label for="login-password">{{ i18n.gettext('Password') }}</label>
                <input class="form-control input-small" type="password" name="__login_password"
                  placeholder='{{ i18n.gettext('Password') }}'
                  required="required">

                <div class="checkbox">
                  <label>
                    <input type="checkbox" name="remember"> {{ i18n.gettext('Remember me?') }}
                  </label>
                </div>

                <button type="submit" class='btn btn-default btn-block'>
                  {{ i18n.gettext('Login') }}
                </button>

                <div class="divider"></div>

                <a href="user?@template=forgotten">{{ i18n.gettext('Forgot password?') }}</a>

                <input type="hidden" name="@action" value="login">
                <input type="hidden" name="__came_from"
                  value='{{request.base}}{{request.env.PATH_INFO}}'>
              </fieldset>
            </form>
          </div>
        </li>
      {% else %}
        {% if request.user.hasPermission('View', 'user') %}
          <li class='dropdown'>
            <a class="dropdown-toggle" href="#" data-toggle="dropdown">
              <i class='fa fa-eye-open'></i> {{ i18n.gettext('Administration') }}
              <span class="caret"></span>
            </a>
            <ul class="dropdown-menu" role="menu" aria-labelledby="user-menu">
            {% if request.user.hasPermission('View', 'user') %}
              <li>
                <a href="user">
                  <i class="fa fa-fw fa-group"></i> {{ i18n.gettext('User List') }}
                </a>
              </li>
            {% endif %}
            {% if request.user.hasPermission('Create', 'user') %}
              <li>
                <a href="user?@template=add">
                  <i class="fa fa-fw fa-plus"></i> {{ i18n.gettext('Add User') }}
                </a>
              </li>
            {% endif %}
            </ul>
          </li>
        {% endif %}
        <li class='dropdown'>
          <a class="dropdown-toggle" href="#" data-toggle="dropdown">
            <i class='fa fa-user'></i> {{ i18n.gettext('Your Profile') }}
            <span class="caret"></span>
          </a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="user-menu">
            <li>
              <a href="user{{ request.user.id }}">
                <i class="fa fa-fw fa-cogs"></i> {{ i18n.gettext('Your Details') }}
              </a>
              <li>
                <a href="{{ request.indexargs_url('issue', {
                  '@sort': '-activity',
                  '@group': 'priority',
                  '@filter': 'status,assignedto',
                  '@columns': 'id,activity,title,creator,status,project',
                  '@search_text': '',
                  'status': status_notresolved,
                  'assignedto': request.user.id,
                  '@dispname': i18n.gettext('Your tasks'),
                }) }}">
                  <i class="fa fa-fw fa-tasks"></i> {{ i18n.gettext('Your Issues') }}
                </a>
              </li>
              <li>
                <a href="{{ request.indexargs_url('', {'@action':'logout'}) }}">
                  <i class="fa fa-fw fa-sign-out"></i> {{ i18n.gettext('Logout') }}
                </a>
              </li>
            </li>
          </ul>
        </li>
      {% endif %}
    </ul>
  </nav>
</header>
